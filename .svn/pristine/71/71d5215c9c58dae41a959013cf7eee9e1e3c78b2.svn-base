<%@ page language="java" import="java.util.*" pageEncoding="utf-8"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>My JSP 'report_forms1.jsp' starting page</title>

<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
<meta http-equiv="description" content="This is my page">
<!--
	<link rel="stylesheet" type="text/css" href="styles.css">
	-->
<link rel="../shortcut icon" href="favicon.ico">
<link href="../css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
<link href="../css/font-awesome.css?v=4.4.0" rel="stylesheet">
<link href="../css/plugins/bootstrap-table/bootstrap-table.min.css"
	rel="stylesheet">
<link href="../css/animate.css" rel="stylesheet">
<link href="../css/style.css?v=4.1.0" rel="stylesheet">
<style type="text/css">
.sumColor {
	background-color: #bbffbb;
}
#example{
	width:auto;
	min-width:
}
#bsize{
	width:100%;
}
</style>
</head>

<body>
	<div id="example">
		<div class="row form-group">
			<div class="form-group col-sm-6">
				<label class="col-sm-2 control-label">日期：</label>
				<div class="col-sm-10">
					<input placeholder="开始日期" class="form-control layer-date"
						id="start"> <input placeholder="结束日期"
						class="form-control layer-date" id="end">
				</div>
			</div>
		</div>
		<!-- 		<button type="button" class="btn btn-primary">导出</button>
 -->
		<table id="bsize" class="table table-striped" border="1">
			<thead>
				<tr class="">
					<th colspan="12"><h3>预算利润表</h3>
					</th>
				</tr>
				<tr class="">
					<th>项目名称</th>
					<th>公司合计</th>
				</tr>
			</thead>
			<tbody id="gridImport_body">
				<tr class="include">

					<td value="">营业收入</td>

				</tr>
				<tr class="include-s">

					<td value="">商品销售收入</td>

				</tr>
				<tr class="include-z">

					<td value="61928-1925">&nbsp;&nbsp;&nbsp;&nbsp;其中：总包配送收入</td>

				</tr>
				<tr class="include-ys">

					<td value="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有色收入</td>

				</tr>
				<tr class="include-zcb">

					<td value="">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;总承包收入</td>

				</tr>
				<tr class="include-qt">

					<td value="3896-5176">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;其他销售收入</td>

				</tr>
				<tr class="include-lw">

					<td value="1930">劳务收入</td>
				</tr>
				<tr class="include-ct">

					<td value="1929">其中：成套服务费收入</td>

				</tr>
				<tr class="include-zb">

					<td value="1931">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;招标服务费收入</td>
				</tr>
				<tr class="include-bs">

					<td value="1934">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;标书费收入</td>

				</tr>
				<tr class="include-jz">

					<td value="1933">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;监造费收入</td>

				</tr>
				<tr class="include-zx">

					<td value="1935-1936">咨询、认证收入</td>
				</tr>
				<tr class="include-dl">

					<td value="1932">代理服务收入</td>
				</tr>
				<tr class="include-qts">

					<td value="1937-1954-1938-1940-1951-1952-5880-5882">其他收入</td>

				</tr>
				<tr class="include-qtw">

					<td value="1968-1977-1973-1970-1971-1972-1973-1974-1975">其他业务收入</td>

				</tr>
				<tr class="cost">

					<td value="">二、营业成本（减）</td>

				</tr>
				<tr class="cost-sp">
					<td value="">商品销售成本</td>

				</tr>
				<tr class="cost-z">
					<td value="1998-2001-2002">其中：总包配送成本</td>
				</tr>
				<tr class="cost-ys">
					<td value="">有色成本</td>

				</tr>
				<tr class="cost-zc">
					<td value="">总承包成本</td>

				</tr>
				<tr class="cost-qt">
					<td value="3876-4797-6098">其他销售成本</td>

				</tr>
				<tr class="cost-lw">
					<td value="">劳务成本</td>
				</tr>
				<tr class="cost-cl">
					<td value="2029">其中：差旅费</td>
				</tr>
				<tr class="cost-hy">
					<td value="2025">会议费</td>
				</tr>
				<tr class="cost-bs">
					<td value="2027">标书支出</td>
				</tr>
				<tr class="cost-ysf">
					<td value="2043">印刷费</td>
				</tr>
				<tr class="cost-zj">
					<td value="2031">专家顾问费</td>
				</tr>
				<tr class="cost-lwf">
					<td value="">劳务费</td>
				</tr>
				<tr class="cost-fw">
					<td value="2030">服务费</td>

				</tr>
				<tr class="cost-qtfy">
					<td value="2032">其他费用</td>

				</tr>
				<tr class="cost-qtyw">
					<td value="2129">其他业务成本</td>
				</tr>
				<tr class="cost-zjft">
					<td value="5977">折旧费用</td>

				</tr>
				<tr class="gross">
					<td value="">三、业务毛利</td>

				</tr>
				<tr class="gross-sp">
					<td value="">商品销售毛利</td>

				</tr>
				<tr class="gross-z">
					<td value="">其中：总包配送毛利</td>

				</tr>
				<tr class="gross-y">
					<td value="">有色毛利</td>

				</tr>
				<tr class="gross-zc">
					<td value="">总承包毛利</td>
				</tr>
				<tr class="gross-qt">
					<td value="">其他销售毛利</td>
				</tr>
				<tr class="gross-lw">
					<td value="">劳务毛利</td>

				</tr>
				<tr class="gross-qtyw">
					<td value="">其他业务毛利</td>

				</tr>
				<tr class="gross-yysj">
					<td value="2144">营业税金及附加（减）</td>

				</tr>
				<tr class="gross-xs">
					<td value="">销售费用（减）</td>

				</tr>
				<tr class="gross-gl">
					<td value="">管理费用（减）</td>

				</tr>
				<tr class="gross-cw">
					<td value="">财务费用（减）</td>
				</tr>
				<tr class="gross-zcjz">
					<td value="">资产减值损失（减）</td>
				</tr>
				<tr class="gross-gyjz">
					<td value="">公允价值变动损益（加）</td>
				</tr>
				<tr class="gross-tz">
					<td value="1982">投资收益（加）</td>
				</tr>
				<tr class="gain">
					<td value="">四、营业利润</td>
				</tr>
				<tr class="gain-yywsr">
					<td value="1996">营业外收入（加）</td>
				</tr>
				<tr class="gain-yywzc">
					<td value="2315">营业外支出（减）</td>
				</tr>
				<tr class="gainSum">
					<td value="">五、利润总额</td>

				</tr>
				<tr class="adjust-bq">
					<td value="">六、本期调整</td>

				</tr>
				<tr class="adjust-qt">
					<td value="">其他调整</td>

				</tr>
				<tr class="adjust-lrz">
					<td value="">七、调整后利润总额</td>

				</tr>
			</tbody>

		</table>
	</div>
	<!-- 全局js -->
	<script src="../js/jquery.min.js?v=2.1.4"></script>
	<script src="../js/bootstrap.min.js?v=3.3.6"></script>
	<!-- Bootstrap table -->
	<script src="../js/plugins/bootstrap-table/bootstrap-table.min.js"></script>
	<script
		src="../js/plugins/bootstrap-table/bootstrap-table-mobile.min.js"></script>
	<script
		src="../js/plugins/bootstrap-table/locale/bootstrap-table-zh-CN.min.js"></script>

	<!-- Peity -->
	<script src="../js/demo/bootstrap-table-demo.js"></script>
	<!-- 自定义js -->
	<script src="../js/content.js?v=1.0.0"></script>
	<!-- layerDate plugin javascript -->
	<script src="../js/plugins/layer/laydate/laydate.js"></script>
	<script>
/* 	var d = document.getElementById("gridImport_body").children;					 	console.info(data+":"+address);
 */
	
		$(function() {
			var gsx = null;//部门
			var xmy = null;//项目
			var tbody = $("#example>table>tbody>tr");
			function dl() {
				$.ajax({
					//url:"http://localhost:8080/web/profit/getCompanyData.do",
					url : "../../profit/getCompanyData.do",
					async : false,
					type : "post",
					//contentType: "application/json; charset=utf-8", 
					data : {
						"type" : "bu_men"
					},
					dataType : "json",
					error : function(result) { //失败 
						alert(result);
					},
					success : function(result) {
						if (result) {
							gsx = result;
							for ( var i = 0; i < result.length; i++) {
								var a = "<th>" + result[i].name + "</th>";
								$("#example>table>thead>tr:last()").append(a);

							}
							/*  data(); */
							bur("",""); 
						}

					}

				});

				//bur();
				var startDate = null, endDate = null;

				function bur(data,address) {
					var d = document.getElementById("gridImport_body").children;
					 for(var j = 0,n =d.length;j<n;j++){
					 data = $("."+d[j].className+">td:first").attr("value");
					 address=$("."+d[j].className);
					 	
					 	address.append("<td></td>");//合计
					 for(var i = 0,num = gsx.length;i<num;i++){
					 
					 	if(data!=""){
					 		$.ajax({
								url : "../../profit/getProfitData.do",
								async : false,
								type : "post",
								data : {
									"lngaccountId" : data,//项目id
									"lngdepartmentId" : gsx[i].code,//公司code
									"startDate" : "2018-01-01",
									"endDate" : "2018-02-28"
								},
								dataType : "json",
								error : function(result) { //失败 
									alert(result);
								},
								success : function(result) {
									address.append($("<td id="+data+gsx[i].code+">" + result.data + "</td>"));
								}
							});
					 	}else{
					 		address.append($("<td>" +0 + "</td>"));
					 	}
					 }
					}
				}
				
				//表格对应数据
				function data() {
					var data1 = $(".include-z>td:first").attr("value"), data2 = $(
							".include-qt>td:first").attr("value"), data3 = $(
							".include-lw>td:first").attr("value"), data4 = $(
							".include-ct>td:first").attr("value"), data5 = $(
							".include-zb>td:first").attr("value"), data6 = $(
							".include-bs>td:first").attr("value"), data7 = $(
							".include-jz>td:first").attr("value"), data8 = $(
							".include-zx>td:first").attr("value"), data9 = $(
							".include-dl>td:first").attr("value"), data10 = $(
							".include-qts>td:first").attr("value"), data11 = $(
							".include-qtw>td:first").attr("value"), data12 = $(
							".cost-z>td:first").attr("value"), data13 = $(
							".cost-qt>td:first").attr("value"), data14 = $(
							".cost-cl>td:first").attr("value"), data15 = $(
							".cost-hy>td:first").attr("value"), data16 = $(
							".cost-bs>td:first").attr("value"), data17 = $(
							".cost-ys>td:first").attr("value"), data18 = $(
							".cost-zj>td:first").attr("value"), data19 = $(
							".cost-fw>td:first").attr("value"), data20 = $(
							".cost-qtfy>td:first").attr("value"), data21 = $(
							".cost-qtyw>td:first").attr("value"), data22 = $(
							".cost-zjft>td:first").attr("value"), data23 = $(
							".gross-yysj>td:first").attr("value"), data24 = $(
							".gross-tz>td:first").attr("value"), data25 = $(
							".gain-yywsr>td:first").attr("value"), data26 = $(
							".gain-yywzc>td:first").attr("value");					
					/* bur(data1,$(".include-z"));
					bur(data2,$(".include-qt"));
					bur(data3,$(".include-lw"));
					bur(data4,$(".include-ct"));
					bur(data5,$(".include-zb"));
					bur(data6,$(".include-bs"));
					bur(data7,$(".include-jz"));
					bur(data8,$(".include-zx"));
					bur(data9,$(".include-dl"));
					bur(data10,$(".include-qts"));
					bur(data11,$(".include-qtw"));
					bur(data12,$(".cost-z"));
					bur(data13,$(".cost-qt"));
					bur(data14,$(".cost-cl"));
					bur(data15,$(".cost-hy"));
					bur(data16,$(".cost-bs"));
					bur(data17,$(".cost-ys"));
					bur(data18,$(".cost-zj"));
					bur(data19,$(".cost-fw"));
					bur(data20,$(".cost-qtfy"));
					bur(data21,$(".cost-qtyw"));
					bur(data22,$(".cost-zjft"));
					bur(data23,$(".gross-yysj"));
					bur(data24,$(".gross-tz"));
					bur(data25,$(".gain-yywsr"));
					bur(data26,$(".gain-yywzc")); */
					addColor();
				}
				
			}
			
			
			
			//为表格添加样式
			function addColor(){
			
				$("tbody tr").find("td:eq(1)").addClass("sumColor");
				$(".include-s>td:gt(0)").addClass("sumColor");
				$(".include-lw>td:gt(0)").addClass("sumColor");
				$(".cost>td:gt(0)").addClass("sumColor");
				$(".cost-sp>td:gt(0)").addClass("sumColor");
				$(".cost-qt>td:gt(0)").addClass("sumColor");
				$(".gross>td:gt(0)").addClass("sumColor");
				$(".gross-sp>td:gt(0)").addClass("sumColor");
				$(".gross-z>td:gt(0)").addClass("sumColor");
				$(".gross-y>td:gt(0)").addClass("sumColor");
				$(".gross-zc>td:gt(0)").addClass("sumColor");
				$(".gross-qt>td:gt(0)").addClass("sumColor");
				$(".gross-lw>td:gt(0)").addClass("sumColor");
				$(".gross-qtyw>td:gt(0)").addClass("sumColor");
				$(".gross-xs>td:gt(0)").addClass("sumColor");
				$(".gross-gl>td:gt(0)").addClass("sumColor");
				$(".gross-cw>td:gt(0)").addClass("sumColor");
				$(".gain>td:gt(0)").addClass("sumColor");
				$(".gainSum>td:gt(0)").addClass("sumColor");
				$(".adjust>td:gt(0)").addClass("sumColor");
				$(".adjust-bq>td:gt(0)").addClass("sumColor");
				$(".adjust-qt>td:gt(0)").addClass("sumColor");
				$(".adjust-lrz>td:gt(0)").addClass("sumColor");
			}
			//接收表格数据
			function dl2(projectId, companyCode) {
				var data2;
				$.ajax({
					//url:"http://localhost:8080/web/profit/getCompanyData.do",
					url : "../../profit/getProfitData.do",
					async : false,
					type : "post",
					//contentType: "application/json; charset=utf-8", 
					data : {
						"lngaccountId" : projectId,//项目id
						"lngdepartmentId" : companyCode,//公司code
						"startDate" : "2018-02-01",
						"endDate" : "2018-02-28"
					},
					dataType : "json",
					error : function(result) { //失败 
						alert(result);
					},
					success : function(result) {

						if (result) {
							data2 = result;

						}
					}

				});
				return data2;

			}
			dl();
		});
	</script>

</body>
</html>
